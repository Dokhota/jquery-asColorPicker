/*! colorInput - v0.1.3 - 2014-02-19
* https://github.com/amazingSurge/jquery-colorInput
* Copyright (c) 2014 amazingSurge; Licensed GPL */
$.colorInput.registerComponent("saturation",{template:'<div class="colorInput-saturation drag-disable"><i class="drag-disable"><b class="drag-disable"></b></i></div>',defaults:{},options:{},width:0,height:0,size:6,data:{},init:function(t){var e=$.extend(this.defaults,t.options.components.saturation),o=this;this.options=e,this.$saturation=$(this.template).appendTo(t.$picker),this.$handle=this.$saturation.children("i"),this.step={},this.$saturation.on("mousedown.colorInput",function(e){var i=e.which?3===e.which:2===e.button;return i?!1:($.proxy(o.mousedown,o)(t,e),void 0)}),t.$element.on("colorInput::ready",function(){o.width=o.$saturation.width(),o.height=o.$saturation.height(),o.step.left=o.width/20,o.step.top=o.height/20,o.size=o.$handle.width()/2,o.update(t),o.keyboard(t)})},mousedown:function(t,e){var o=this.$saturation.offset();return this.data.startY=e.pageY,this.data.startX=e.pageX,this.data.top=e.pageY-o.top,this.data.left=e.pageX-o.left,this.data.cach={},this.move(t,this.data.left,this.data.top),t.makeUnselectable(),this.mousemove=function(e){var o=this.data.left+(e.pageX||this.data.startX)-this.data.startX,i=this.data.top+(e.pageY||this.data.startY)-this.data.startY;return this.move(t,o,i),!1},this.mouseup=function(){return $(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),this.data.left=this.data.cach.left,this.data.top=this.data.cach.top,t.cancelUnselectable(),!1},$(document).on({mousemove:$.proxy(this.mousemove,this),mouseup:$.proxy(this.mouseup,this)}),!1},move:function(t,e,o,i){o=Math.max(0,Math.min(this.height,o)),e=Math.max(0,Math.min(this.width,e)),void 0===this.data.cach&&(this.data.cach={}),this.data.cach.left=e,this.data.cach.top=o,this.$handle.css({top:o-this.size,left:e-this.size}),i!==!1&&t.update({s:e/this.width,v:1-o/this.height},"saturation")},update:function(t){void 0===t.color.value.h&&(t.color.value.h=0),this.$saturation.css("backgroundColor",$.colorValue.HSLToHEX({h:t.color.value.h,s:1,l:.5}));var e=t.color.value.s*this.width,o=(1-t.color.value.v)*this.height;this.move(t,e,o,!1)},moveLeft:function(t){var e=this.step.left,o=this.data;o.left=o.left-e,o.left=Math.max(0,Math.min(this.width,o.left)),this.move(t,o.left,o.top)},moveRight:function(t){var e=this.step.left,o=this.data;o.left=o.left+e,o.left=Math.max(0,Math.min(this.width,o.left)),this.move(t,o.left,o.top)},moveUp:function(t){var e=this.step.top,o=this.data;o.top=o.top-e,o.top=Math.max(0,Math.min(this.width,o.top)),this.move(t,o.left,o.top)},moveDown:function(t){var e=this.step.top,o=this.data;o.top=o.top+e,o.top=Math.max(0,Math.min(this.width,o.top)),this.move(t,o.left,o.top)},keyboard:function(t){var e,o=this;return t._keyboard?(e=$.extend(!0,{},t._keyboard),this.$saturation.attr("tabindex","0").on("focus",function(){return e.attach({left:function(){o.moveLeft.call(o,t)},right:function(){o.moveRight.call(o,t)},up:function(){o.moveUp.call(o,t)},down:function(){o.moveDown.call(o,t)}}),!1}).on("blur",function(){e.detach()}),void 0):!1},destroy:function(){$(document).off({mousemove:this.mousemove,mouseup:this.mouseup})}});