/*! colorInput - v0.1.3 - 2014-03-14
* https://github.com/amazingSurge/jquery-colorInput
* Copyright (c) 2014 amazingSurge; Licensed GPL */
(function(t){t.colorInput.registerComponent("saturation",{defaults:{},options:{},width:0,height:0,size:6,data:{},init:function(e){var i=t.extend(this.defaults,e.options.components.saturation),o=this,a='<div class="'+e.namespace+'-saturation drag-disable"><i class="drag-disable"><b class="drag-disable"></b></i></div>';this.options=i,this.$saturation=t(a).appendTo(e.$picker),this.$handle=this.$saturation.children("i"),this.step={},this.$saturation.on("mousedown.colorInput",function(i){var a=i.which?3===i.which:2===i.button;return a?!1:(t.proxy(o.mousedown,o)(e,i),void 0)}),e.$element.on("colorInput::ready",function(){o.width=o.$saturation.width(),o.height=o.$saturation.height(),o.step.left=o.width/20,o.step.top=o.height/20,o.size=o.$handle.width()/2,o.update(e),o.keyboard(e)})},mousedown:function(e,i){var o=this.$saturation.offset();return this.data.startY=i.pageY,this.data.startX=i.pageX,this.data.top=i.pageY-o.top,this.data.left=i.pageX-o.left,this.data.cach={},this.move(e,this.data.left,this.data.top),e.makeUnselectable(),this.mousemove=function(t){var i=this.data.left+(t.pageX||this.data.startX)-this.data.startX,o=this.data.top+(t.pageY||this.data.startY)-this.data.startY;return this.move(e,i,o),!1},this.mouseup=function(){return t(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),this.data.left=this.data.cach.left,this.data.top=this.data.cach.top,e.cancelUnselectable(),!1},t(document).on({mousemove:t.proxy(this.mousemove,this),mouseup:t.proxy(this.mouseup,this)}),!1},move:function(t,e,i,o){i=Math.max(0,Math.min(this.height,i)),e=Math.max(0,Math.min(this.width,e)),void 0===this.data.cach&&(this.data.cach={}),this.data.cach.left=e,this.data.cach.top=i,this.$handle.css({top:i-this.size,left:e-this.size}),o!==!1&&t.update({s:e/this.width,v:1-i/this.height},"saturation")},update:function(e){void 0===e.color.value.h&&(e.color.value.h=0),this.$saturation.css("backgroundColor",t.colorValue.HSLToHEX({h:e.color.value.h,s:1,l:.5}));var i=e.color.value.s*this.width,o=(1-e.color.value.v)*this.height;this.move(e,i,o,!1)},moveLeft:function(t){var e=this.step.left,i=this.data;i.left=i.left-e,i.left=Math.max(0,Math.min(this.width,i.left)),this.move(t,i.left,i.top)},moveRight:function(t){var e=this.step.left,i=this.data;i.left=i.left+e,i.left=Math.max(0,Math.min(this.width,i.left)),this.move(t,i.left,i.top)},moveUp:function(t){var e=this.step.top,i=this.data;i.top=i.top-e,i.top=Math.max(0,Math.min(this.width,i.top)),this.move(t,i.left,i.top)},moveDown:function(t){var e=this.step.top,i=this.data;i.top=i.top+e,i.top=Math.max(0,Math.min(this.width,i.top)),this.move(t,i.left,i.top)},keyboard:function(e){var i,o=this;return e._keyboard?(i=t.extend(!0,{},e._keyboard),this.$saturation.attr("tabindex","0").on("focus",function(){return i.attach({left:function(){o.moveLeft.call(o,e)},right:function(){o.moveRight.call(o,e)},up:function(){o.moveUp.call(o,e)},down:function(){o.moveDown.call(o,e)}}),!1}).on("blur",function(){i.detach()}),void 0):!1},destroy:function(){t(document).off({mousemove:this.mousemove,mouseup:this.mouseup})}})})(jQuery);