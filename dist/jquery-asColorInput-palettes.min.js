/*! asColorInput - v0.1.3 - 2014-05-09
* https://github.com/amazingSurge/jquery-asColorInput
* Copyright (c) 2014 amazingSurge; Licensed GPL */
(function(t){t.asColorInput.registerComponent("palettes",{height:150,palettes:{defines:[""],colors:["#fff","#000","#000","#ccc"],max:6},init:function(e){var i="<ul>",a=this,o=t.extend(!0,{},this.palettes,e.options.components.palettes);if(this.keyboardBinded=!1,e.options.localStorage){var s="palettes_"+e.id,n=e.getLocalItem(s);n&&(o.colors=n)}t.each(o.colors,function(t,e){i+='<li style="background-color:'+e+'" data-color="'+e+'">'+e+"</li>"}),i+="</ul>",this.$list=t(i),this.$palettes=t('<div class="'+e.namespace+'-palettes"></div>').append(this.$list).appendTo(e.$picker),this.$palettes.delegate("li","click",function(i){var o=t(i.target).data("color");a.$list.find("li").removeClass(""+e.namespace+"-palettes-checked"),t(i.target).addClass(""+e.namespace+"-palettes-checked"),e.set(o)}),this.$palettes.attr("tabindex","0").on("blur",function(){a.$list.find("li").removeClass(""+e.namespace+"-palettes-checked")}),e.$element.on("asColorInput::apply",function(t,e){-1===o.colors.indexOf(e.originalColor)&&(o.colors.length>=o.max&&(o.colors.shift(),a.$list.find("li").eq(0).remove()),o.colors.push(e.originalColor),a.$list.append('<li style="background-color:'+e.originalColor+'" data-color="'+e.originalColor+'">'+e.originalColor+"</li>"),e.options.localStorage&&e.setLocalItem(s,o.colors))}),e.$element.on("asColorInput::ready",function(){return a.keyboard(e),!1})},keyboard:function(e){var i,a,o,s=this;return e._keyboard?(i=t.extend(!0,{},e._keyboard),this.$palettes.attr("tabindex","0").on("blur",function(){i.detach(),s.keyboardBinded=!1}),this.$palettes.attr("tabindex","0").on("focus",function(){function t(t){h.removeClass(e.namespace+"-palettes-checked"),h.eq(t).addClass(e.namespace+"-palettes-checked")}function n(){return h.index(s.$palettes.find("."+e.namespace+"-palettes-checked"))}if(s.keyboardBinded!==!0){var h=s.$list.find("li");a=-1,o=h.length,i.attach({left:function(){var e=n();-1===e?a-=1:a=e-1,0>a&&(a=o-1),t(a)},right:function(){var e=n();-1===e?a+=1:a=e+1,a>=o&&(a=0),t(a)},RETURN:function(){if(!(0>a)){var t=h.eq(a).data("color");e.set(t),e.close()}}}),s.keyboardBinded=!0}}),void 0):!1}})})(jQuery);