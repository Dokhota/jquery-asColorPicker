/*! asColorInput - v0.1.3 - 2014-07-21
* https://github.com/amazingSurge/jquery-asColorInput
* Copyright (c) 2014 amazingSurge; Licensed GPL */
!function(a){a.asColorInput.registerComponent("saturation",{defaults:{},width:0,height:0,size:6,data:{},init:function(b,c){var d=this,e='<div class="'+b.namespace+'-saturation"><i><b></b></i></div>';this.options=a.extend(this.defaults,c),this.$saturation=a(e).appendTo(b.$dropdown),this.$handle=this.$saturation.children("i"),b.$element.on("asColorInput::firstOpen",function(){d.width=d.$saturation.width(),d.height=d.$saturation.height(),d.step={left:d.width/20,top:d.height/20},d.size=d.$handle.width()/2,d.update(b),d.bindEvents(b),d.keyboard(b)})},bindEvents:function(b){var c=this;this.$saturation.on("mousedown.asColorInput",function(d){var e=d.which?3===d.which:2===d.button;return e?!1:void a.proxy(c.mousedown,c)(b,d)})},mousedown:function(b,c){var d=this.$saturation.offset();return this.data.startY=c.pageY,this.data.startX=c.pageX,this.data.top=c.pageY-d.top,this.data.left=c.pageX-d.left,this.data.cach={},this.move(b,this.data.left,this.data.top),this.mousemove=function(a){var c=this.data.left+(a.pageX||this.data.startX)-this.data.startX,d=this.data.top+(a.pageY||this.data.startY)-this.data.startY;return this.move(b,c,d),!1},this.mouseup=function(){return a(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),this.data.left=this.data.cach.left,this.data.top=this.data.cach.top,!1},a(document).on({mousemove:a.proxy(this.mousemove,this),mouseup:a.proxy(this.mouseup,this)}),!1},move:function(a,b,c,d){c=Math.max(0,Math.min(this.height,c)),b=Math.max(0,Math.min(this.width,b)),void 0===this.data.cach&&(this.data.cach={}),this.data.cach.left=b,this.data.cach.top=c,this.$handle.css({top:c-this.size,left:b-this.size}),d!==!1&&a.update({s:b/this.width,v:1-c/this.height},"saturation")},update:function(b){void 0===b.color.value.h&&(b.color.value.h=0),this.$saturation.css("backgroundColor",a.asColor.HSLToHEX({h:b.color.value.h,s:1,l:.5}));var c=b.color.value.s*this.width,d=(1-b.color.value.v)*this.height;this.move(b,c,d,!1)},moveLeft:function(a){var b=this.step.left,c=this.data;c.left=Math.max(0,Math.min(this.width,c.left-b)),this.move(a,c.left,c.top)},moveRight:function(a){var b=this.step.left,c=this.data;c.left=Math.max(0,Math.min(this.width,c.left+b)),this.move(a,c.left,c.top)},moveUp:function(a){var b=this.step.top,c=this.data;c.top=Math.max(0,Math.min(this.width,c.top-b)),this.move(a,c.left,c.top)},moveDown:function(a){var b=this.step.top,c=this.data;c.top=Math.max(0,Math.min(this.width,c.top+b)),this.move(a,c.left,c.top)},keyboard:function(b){var c,d=this;return b._keyboard?(c=a.extend(!0,{},b._keyboard),void this.$saturation.attr("tabindex","0").on("focus",function(){return c.attach({left:function(){d.moveLeft.call(d,b)},right:function(){d.moveRight.call(d,b)},up:function(){d.moveUp.call(d,b)},down:function(){d.moveDown.call(d,b)}}),!1}).on("blur",function(){c.detach()})):!1},destroy:function(){a(document).off({mousemove:this.mousemove,mouseup:this.mouseup})}})}(jQuery);