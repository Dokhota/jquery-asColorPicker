/*! asColorInput - v0.1.3 - 2014-08-26
* https://github.com/amazingSurge/jquery-asColorInput
* Copyright (c) 2014 amazingSurge; Licensed GPL */
!function(a,b,c,d,e){"use strict";function f(a){a.id=g,g++}var g=0,h=(!!/msie/i.exec(a.navigator.userAgent),c.asColorInput=function(a,b){this.element=a,this.$element=c(a),this.opened=!1,this.firstOpen=!0,this.disabled=!1,this.initialed=!1,f(this),this.options=c.extend(!0,{},h.defaults,b,this.$element.data()),this.namespace=this.options.namespace,this.classes={wrap:this.namespace+"-wrap",dropdown:this.namespace+"-dropdown",input:this.namespace+"-input",skin:this.namespace+"_"+this.options.skin,open:this.namespace+"_open",mask:this.namespace+"-mask",hideInput:this.namespace+"_hideInput",disabled:this.namespace+"_disabled",mode:this.namespace+"-mode_"+this.options.mode},this.options.hideInput&&this.$element.addClass(this.classes.hideInput),this.components=c.extend(!0,{},this.components),this._comps=h.modes[this.options.mode],this._trigger("init"),this.init()});h.prototype={constructor:h,components:{},init:function(){this.color=new d(this.element.value,this.options.format,this.options.color),this._create(),this.options.skin&&(this.$dropdown.addClass(this.classes.skin),this.$element.parent().addClass(this.classes.skin)),this.options.readonly&&this.$element.prop("readonly",!0),this._bindEvent(),this.initialed=!0,this._trigger("ready")},_create:function(){var a=this;this.$dropdown=c('<div class="'+this.classes.dropdown+'" data-mode="'+this.options.mode+'"></div>'),this.$element.wrap('<div class="'+this.classes.wrap+'"></div>').addClass(this.classes.input),this.$wrap=this.$element.parent(),this.$body=c("body"),this.$dropdown.data("asColorInput",this),c.each(this._comps,function(b,d){d===!0&&(d={}),a.options.components[b]!==e&&(d=c.extend(d,a.options.components[b])),a.components[b]&&a.components[b].init(a,d)}),this._trigger("create")},_bindEvent:function(){var a=this;this.$element.on({"click.asColorInput":function(){return a.opened||a.open(),!1},"keydown.asColorInput":function(b){9===b.keyCode?a.close():13===b.keyCode&&a.val(a.$element.val())},"keyup.asColorInput":function(){}})},_trigger:function(a){var b,c=arguments.length>1?Array.prototype.slice.call(arguments,1):e;c?(b=c,b.push(this)):b=this,this.$element.trigger("asColorInput::"+a,b),this.$element.trigger(a+".asColorInput",b),a=a.replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});var d="on"+a;"function"==typeof this.options[d]&&this.options[d].apply(this,c)},update:function(){this._trigger("update",this.color),this._trigger("change",this.val(),this.options.name,"asColorInput"),this.$element.val(this.color.toString())},opacity:function(a){return a?void this.color.alpha(a):this.color.alpha()},position:function(){var b,d,e=!this.$element.is(":visible"),f=e?this.$trigger.offset():this.$element.offset(),g=e?this.$trigger.outerHeight():this.$element.outerHeight(),h=e?this.$trigger.outerWidth():this.$element.outerWidth()+this.$trigger.outerWidth(),i=this.$dropdown.outerWidth(!0),j=this.$dropdown.outerHeight(!0);b=j+f.top>c(a).height()+c(a).scrollTop()?f.top-j:f.top+g,d=i+f.left>c(a).width()+c(a).scrollLeft()?f.left-i+h:f.left,this.$dropdown.css({position:"absolute",top:b,left:d})},open:function(){if(!this.disabled){var b=this;this.$dropdown[0]!==this.$body.children().last()[0]&&this.$dropdown.detach().appendTo(this.$body),this.$mask=c("."+b.classes.mask),0==this.$mask.length&&this.createMask(),this.$dropdown.prev()[0]!==this.$mask[0]&&this.$dropdown.before(this.$mask),c("#asColorInput-dropdown").removeAttr("id"),this.$dropdown.attr("id","asColorInput-dropdown"),this.$mask.show(),this.position(),c(a).on("resize.asColorInput",c.proxy(this.position,this)),this.$dropdown.addClass(this.classes.open),this.opened=!0,this.firstOpen&&(this.firstOpen=!1,this._trigger("firstOpen")),this._trigger("open")}},createMask:function(){this.$mask=c(b.createElement("div")),this.$mask.attr("class",this.classes.mask),this.$mask.hide(),this.$mask.appendTo(this.$body);this.$mask.on("mousedown touchstart click",function(a){var b,d=c("#asColorInput-dropdown");d.length>0&&(b=d.data("asColorInput"),b.opened&&(b.options.hideFireChange?b.apply():b.cancel()),a.preventDefault(),a.stopPropagation())})},close:function(){this.opened=!1,this.$element.blur(),this.$mask.hide(),this.$dropdown.removeClass(this.classes.open),c(a).off("resize.asColorInput"),this._trigger("close")},clear:function(){this.val("")},cancel:function(){return this.close(),!1},apply:function(){return this.close(),this._trigger("apply"),!1},val:function(a){return"undefined"==typeof a?this.color.toString():void this.set(a)},set:function(a){return"string"==typeof a?this.color.val(a):this.color.set(a),this.update(),this},get:function(){return this.color},enable:function(){return this.disabled=!1,this.$parent.addClass(this.classes.disabled),this},disable:function(){return this.disabled=!0,this.$parent.removeClass(this.classes.disabled),this},destroy:function(){}},h.registerComponent=function(a,b){h.prototype.components[a]=b},h.localization=[],h.defaults={namespace:"asColorInput",readonly:!1,skin:null,hideInput:!1,hideFireChange:!0,keyboard:!1,format:"rgba",color:{shortenHex:!1,hexUseName:!1,reduceAlpha:!1,nameDegradation:"HEX",invalidValue:"",zeroAlphaAsTransparent:!0},mode:"simple",components:{},onInit:null,onReady:null,onChange:null,onClose:null,onOpen:null,onApply:null},h.modes={simple:{trigger:!0,saturation:!0,hue:!0,alpha:!0},palettes:{trigger:!0,palettes:!0},complex:{trigger:!0,preview:!0,palettes:!0,saturation:!0,hue:!0,alpha:!0,hex:!0,buttons:!0},gradient:{trigger:!0,preview:!0,palettes:!0,saturation:!0,hue:!0,alpha:!0,hex:!0,gradient:!0}},h.registerComponent("trigger",{template:'<div class="asColorInput-trigger"><span></span></div>',init:function(a){var b='<div class="'+a.namespace+'-trigger"><span></span></div>';a.$trigger=c(b),this.$trigger_inner=a.$trigger.children("span"),a.$trigger.insertAfter(a.$element),a.$trigger.on("click",function(){return a.opened?a.close():a.open(),!1});var d=this;a.$element.on("asColorInput::update",function(a,b){d.update(b)}),this.update(a.color)},update:function(a){this.$trigger_inner[0].style.backgroundImage="",this.$trigger_inner.css("backgroundColor",a.toRGBA())},destroy:function(a){a.$trigger.remove()}}),c.fn.asColorInput=function(a){if("string"==typeof a){var b=a,d=arguments.length>1?Array.prototype.slice.call(arguments,1):e;return this.each(function(){var a=c.data(this,"asColorInput");"function"==typeof a[b]&&a[b].apply(a,d)})}return this.each(function(){c.data(this,"asColorInput")||c.data(this,"asColorInput",new h(this,a))})}}(window,document,jQuery,function(a){return void 0===a.asColor?!1:a.asColor}(jQuery)),function(a){"use strict";a.asColorInput.registerComponent("clear",{defaults:{},init:function(b,c){this.options=a.extend(this.defaults,c),this.$clear=a('<a href="#"'+b.namespace+'-clear"></a>').insertAfter(this.$element),this.$clear.on("click",function(){return b.clear(),!1})}})}(jQuery),function(a,b,c){"use strict";var d=c(b),e={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(a){var b=a.keyCode||a.which;return b in e.map&&"function"==typeof e.map[b]&&e.map[b](a),!1},attach:function(a){var b,c;for(b in a)a.hasOwnProperty(b)&&(c=b.toUpperCase(),c in e.keys?e.map[e.keys[c]]=a[b]:e.map[c]=a[b]);e.bound||(e.bound=!0,d.bind("keydown",e.press))},detach:function(){e.bound=!1,e.map={},d.unbind("keydown",e.press)}};d.on("asColorInput::init",function(a,b){b.options.keyboard===!0&&(b._keyboard=e)})}(window,document,jQuery),function(a){"use strict";a.asColorInput.registerComponent("alpha",{size:150,defaults:{direction:"vertical"},data:{},init:function(b,c){var d=this;this.options=a.extend(this.defaults,c),d.direction=this.options.direction,this.api=b,this.$alpha=a('<div class="'+b.namespace+"-alpha "+b.namespace+"-alpha-"+this.direction+'"><i></i></div>').appendTo(b.$dropdown),this.$handle=this.$alpha.children("i"),b.$element.on("asColorInput::firstOpen",function(){d.size="vertical"===d.direction?d.$alpha.height():d.$alpha.width(),d.step=d.size/360,d.update(b.color),d.bindEvents(),d.keyboard()}),b.$element.on("asColorInput::update",function(a,b){d.update(b)})},bindEvents:function(){var b=this;this.$alpha.on("mousedown.asColorInput",function(c){var d=c.which?3===c.which:2===c.button;return d?!1:void a.proxy(b.mousedown,b)(c)})},mousedown:function(b){var c=this.$alpha.offset();return"vertical"===this.direction?(this.data.startY=b.pageY,this.data.top=b.pageY-c.top,this.move(this.data.top)):(this.data.startX=b.pageX,this.data.left=b.pageX-c.left,this.move(this.data.left)),this.mousemove=function(a){var b;return b="vertical"===this.direction?this.data.top+(a.pageY||this.data.startY)-this.data.startY:this.data.left+(a.pageX||this.data.startX)-this.data.startX,this.move(b),!1},this.mouseup=function(){return a(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),"vertical"===this.direction?this.data.top=this.data.cach:this.data.left=this.data.cach,!1},a(document).on({mousemove:a.proxy(this.mousemove,this),mouseup:a.proxy(this.mouseup,this)}),!1},move:function(a,b,c){a=Math.max(0,Math.min(this.size,a)),this.data.cach=a,"undefined"==typeof b&&(b=1-a/this.size),b=Math.max(0,Math.min(1,b)),this.$handle.css("vertical"===this.direction?{top:a}:{left:a}),c!==!1&&this.api.set({a:Math.round(100*b)/100})},moveLeft:function(){var a=this.step,b=this.data;b.left=Math.max(0,Math.min(this.width,b.left-a)),this.move(b.left)},moveRight:function(){var a=this.step,b=this.data;b.left=Math.max(0,Math.min(this.width,b.left+a)),this.move(b.left)},moveUp:function(){var a=this.step,b=this.data;b.top=Math.max(0,Math.min(this.width,b.top-a)),this.move(b.top)},moveDown:function(){var a=this.step,b=this.data;b.top=Math.max(0,Math.min(this.width,b.top+a)),this.move(b.top)},keyboard:function(){var b,c=this;return this.api._keyboard?(b=a.extend(!0,{},this.api._keyboard),void this.$alpha.attr("tabindex","0").on("focus",function(){return b.attach("vertical"===this.direction?{up:function(){c.moveUp()},down:function(){c.moveDown()}}:{left:function(){c.moveLeft()},right:function(){c.moveRight()}}),!1}).on("blur",function(){b.detach()})):!1},update:function(a){var b=this.size*(1-a.value.a);this.$alpha.css("backgroundColor",a.toHEX()),this.move(b,a.value.a,!1)},destroy:function(){a(document).off({mousemove:this.mousemove,mouseup:this.mouseup})}})}(jQuery),function(a){"use strict";a.asColorInput.registerComponent("buttons",{defaults:{apply:!1,cancel:!0,applyText:"apply",cancelText:"cancel"},init:function(b,c){var d=this;this.options=a.extend(this.defaults,c),this.$buttons=a('<div class="'+b.namespace+'-buttons"></div>').appendTo(b.$dropdown),b.$element.on("asColorInput::firstOpen",function(){d.options.apply&&(d.$apply=a('<a href="#" alt="'+d.options.applyText+'" class="'+b.namespace+'-buttons-apply"></a>').text(d.options.applyText).appendTo(d.$buttons).on("click",a.proxy(b.apply,b))),d.options.cancel&&(d.$cancel=a('<a href="#" alt="'+d.options.cancelText+'" class="'+b.namespace+'-buttons-cancel"></a>').text(d.options.cancelText).appendTo(d.$buttons).on("click",a.proxy(b.cancel,b)))})}})}(jQuery),function(a){"use strict";a.asColorInput.registerComponent("hex",{init:function(b){var c='<input type="text" class="'+b.namespace+'-hex" />';this.$hex=a(c).appendTo(b.$dropdown),this.$hex.on("change",function(){b.set(this.value)});var d=this;b.$element.on("asColorInput::update",function(a,b){d.update(b)}),this.update(b.color)},update:function(a){this.$hex.val(a.toHEX())}})}(jQuery),function(a){"use strict";a.asColorInput.registerComponent("hue",{size:150,defaults:{direction:"vertical"},data:{},init:function(b,c){var d=this;this.options=a.extend(this.defaults,c),this.direction=this.options.direction,this.api=b,this.$hue=a('<div class="'+b.namespace+"-hue "+b.namespace+"-hue-"+this.direction+'"><i></i></div>').appendTo(b.$dropdown),this.$handle=this.$hue.children("i"),b.$element.on("asColorInput::firstOpen",function(){d.size="vertical"===d.direction?d.$hue.height():d.$hue.width(),d.step=d.size/360,d.update(b.color),d.bindEvents(b),d.keyboard(b)}),b.$element.on("asColorInput::update",function(a,b){d.update(b)})},bindEvents:function(){var b=this;this.$hue.on("mousedown.asColorInput",function(c){var d=c.which?3===c.which:2===c.button;return d?!1:void a.proxy(b.mousedown,b)(c)})},mousedown:function(b){var c=this.$hue.offset();return"vertical"===this.direction?(this.data.startY=b.pageY,this.data.top=b.pageY-c.top,this.move(this.data.top)):(this.data.startX=b.pageX,this.data.left=b.pageX-c.left,this.move(this.data.left)),this.mousemove=function(a){var b;return b="vertical"===this.direction?this.data.top+(a.pageY||this.data.startY)-this.data.startY:this.data.left+(a.pageX||this.data.startX)-this.data.startX,this.move(b),!1},this.mouseup=function(){return a(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),"vertical"===this.direction?this.data.top=this.data.cach:this.data.left=this.data.cach,!1},a(document).on({mousemove:a.proxy(this.mousemove,this),mouseup:a.proxy(this.mouseup,this)}),!1},move:function(a,b,c){a=Math.max(0,Math.min(this.size,a)),this.data.cach=a,"undefined"==typeof b&&(b=360*(1-a/this.size)),b=Math.max(0,Math.min(360,b)),this.$handle.css("vertical"===this.direction?{top:a}:{left:a}),c!==!1&&this.api.set({h:b})},moveLeft:function(){var a=this.step,b=this.data;b.left=Math.max(0,Math.min(this.width,b.left-a)),this.move(b.left)},moveRight:function(){var a=this.step,b=this.data;b.left=Math.max(0,Math.min(this.width,b.left+a)),this.move(b.left)},moveUp:function(){var a=this.step,b=this.data;b.top=Math.max(0,Math.min(this.width,b.top-a)),this.move(b.top)},moveDown:function(){var a=this.step,b=this.data;b.top=Math.max(0,Math.min(this.width,b.top+a)),this.move(b.top)},keyboard:function(){var b,c=this;return this.api._keyboard?(b=a.extend(!0,{},this.api._keyboard),void this.$hue.attr("tabindex","0").on("focus",function(){return b.attach("vertical"===this.direction?{up:function(){c.moveUp()},down:function(){c.moveDown()}}:{left:function(){c.moveLeft()},right:function(){c.moveRight()}}),!1}).on("blur",function(){b.detach()})):!1},update:function(a){var b=0===a.value.h?0:this.size*(1-a.value.h/360);this.move(b,a.value.h,!1)},destroy:function(){a(document).off({mousemove:this.mousemove,mouseup:this.mouseup})}})}(jQuery),function(a){"use strict";a.asColorInput.registerComponent("info",{color:["white","black","transparent"],init:function(b){var c='<ul class="'+b.namespace+'-info"><li><label>R:<input type="text" data-type="r"/></label></li><li><label>G:<input type="text" data-type="g"/></label></li><li><label>B:<input type="text" data-type="b"/></label></li><li><label>A:<input type="text" data-type="a"/></label></li></ul>';this.$info=a(c).appendTo(b.$dropdown),this.$r=this.$info.find('[data-type="r"]'),this.$g=this.$info.find('[data-type="g"]'),this.$b=this.$info.find('[data-type="b"]'),this.$a=this.$info.find('[data-type="a"]'),this.$info.delegate("input","keyup update change",function(c){var d,e=a(c.target).data("type");switch(e){case"r":case"g":case"b":d=parseInt(this.value,10),d>255?d=255:0>d&&(d=0);break;case"a":d=parseFloat(this.value,10),d>1?d=1:0>d&&(d=0)}isNaN(d)&&(d=0);var f={};f[e]=d,b.set(f)});var d=this;b.$element.on("asColorInput::update",function(a,b){d.update(b)}),this.update(b.color)},update:function(a){this.$r.val(a.value.r),this.$g.val(a.value.g),this.$b.val(a.value.b),this.$a.val(a.value.a)}})}(jQuery),function(a){"use strict";function b(){}window.localStorage||(window.localStorage=b),a.asColorInput.registerComponent("palettes",{defaults:{colors:["#fff","#ffff00","#f00","#0f0","#0ff","#000"],max:10,localStorage:!0},init:function(b,c){var d=this;if(this.options=a.extend(!0,{},this.defaults,c),this.options.localStorage){var e=b.namespace+"_palettes_"+b.id,f=this.getLocalItem(e);f&&(this.options.colors=f)}var g="";a.each(this.options.colors,function(a,b){g+=d.getItem(b)}),this.$palettes=a('<ul class="'+b.namespace+'-palettes"></ul>').html(g).appendTo(b.$dropdown),this.$palettes.delegate("li","click",function(c){var d=a(this).data("color");b.set(d),c.preventDefault(),c.stopPropagation()}),b.$element.on("asColorInput::apply",function(a,b){-1===d.options.colors.indexOf(b.originalColor)&&(d.options.colors.length>=d.options.max&&(d.options.colors.shift(),d.$palettes.find("li").eq(0).remove()),d.options.colors.push(b.originalColor),d.$palettes.append(d.getItem(b.originalColor)),d.options.localStorage&&d.setLocalItem(e,d.options.colors))})},getItem:function(a){return'<li data-color="'+a+'"><div style="background-color:'+a+'" /></li>'},setLocalItem:function(a,b){var c=JSON.stringify(b);localStorage[a]=c},getLocalItem:function(a){var b=localStorage[a];return b?JSON.parse(b):b}})}(jQuery),function(a){"use strict";a.asColorInput.registerComponent("preview",{init:function(b){var c=this,d='<ul class="'+b.namespace+'-preview"><li class="'+b.namespace+'-preview-current"><div /></li><li class="'+b.namespace+'-preview-previous"><div /></li></ul>';this.$preview=a(d).appendTo(b.$dropdown),this.$current=this.$preview.find("."+b.namespace+"-preview-current div"),this.$previous=this.$preview.find("."+b.namespace+"-preview-previous div"),b.$element.on("asColorInput::firstOpen",function(){c.update(b.color),c.$previous.css("backgroundColor",b.color.toRGBA()),b.$element.on("asColorInput::apply",function(a,b){c.$previous.css("backgroundColor",b.color.toRGBA())}),c.$previous.on("click",function(){return!1})}),b.$element.on("asColorInput::update",function(a,b){c.update(b)})},update:function(a){this.$current.css("backgroundColor",a.toRGBA())}})}(jQuery),function(a){"use strict";a.asColorInput.registerComponent("saturation",{defaults:{},width:0,height:0,size:6,data:{},init:function(b,c){var d=this,e='<div class="'+b.namespace+'-saturation"><i><b></b></i></div>';this.options=a.extend(this.defaults,c),this.api=b,this.$saturation=a(e).appendTo(b.$dropdown),this.$handle=this.$saturation.children("i"),b.$element.on("asColorInput::firstOpen",function(){d.width=d.$saturation.width(),d.height=d.$saturation.height(),d.step={left:d.width/20,top:d.height/20},d.size=d.$handle.width()/2,d.update(b.color),d.bindEvents(),d.keyboard(b)}),b.$element.on("asColorInput::update",function(a,b){d.update(b)})},bindEvents:function(){var b=this;this.$saturation.on("mousedown.asColorInput",function(c){var d=c.which?3===c.which:2===c.button;return d?!1:void a.proxy(b.mousedown,b)(c)})},mousedown:function(b){var c=this.$saturation.offset();return this.data.startY=b.pageY,this.data.startX=b.pageX,this.data.top=b.pageY-c.top,this.data.left=b.pageX-c.left,this.data.cach={},this.move(this.data.left,this.data.top),this.mousemove=function(a){var b=this.data.left+(a.pageX||this.data.startX)-this.data.startX,c=this.data.top+(a.pageY||this.data.startY)-this.data.startY;return this.move(b,c),!1},this.mouseup=function(){return a(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),this.data.left=this.data.cach.left,this.data.top=this.data.cach.top,!1},a(document).on({mousemove:a.proxy(this.mousemove,this),mouseup:a.proxy(this.mouseup,this)}),!1},move:function(a,b,c){b=Math.max(0,Math.min(this.height,b)),a=Math.max(0,Math.min(this.width,a)),void 0===this.data.cach&&(this.data.cach={}),this.data.cach.left=a,this.data.cach.top=b,this.$handle.css({top:b-this.size,left:a-this.size}),c!==!1&&this.api.set({s:a/this.width,v:1-b/this.height})},update:function(b){void 0===b.value.h&&(b.value.h=0),this.$saturation.css("backgroundColor",a.asColor.HSLToHEX({h:b.value.h,s:1,l:.5}));var c=b.value.s*this.width,d=(1-b.value.v)*this.height;this.move(c,d,!1)},moveLeft:function(){var a=this.step.left,b=this.data;b.left=Math.max(0,Math.min(this.width,b.left-a)),this.move(b.left,b.top)},moveRight:function(){var a=this.step.left,b=this.data;b.left=Math.max(0,Math.min(this.width,b.left+a)),this.move(b.left,b.top)},moveUp:function(){var a=this.step.top,b=this.data;b.top=Math.max(0,Math.min(this.width,b.top-a)),this.move(b.left,b.top)},moveDown:function(){var a=this.step.top,b=this.data;b.top=Math.max(0,Math.min(this.width,b.top+a)),this.move(b.left,b.top)},keyboard:function(){var b,c=this;return this.api._keyboard?(b=a.extend(!0,{},this.api._keyboard),void this.$saturation.attr("tabindex","0").on("focus",function(){return b.attach({left:function(){c.moveLeft()},right:function(){c.moveRight()},up:function(){c.moveUp()},down:function(){c.moveDown()}}),!1}).on("blur",function(){b.detach()})):!1},destroy:function(){a(document).off({mousemove:this.mousemove,mouseup:this.mouseup})}})}(jQuery),function(a,b){function c(){var a=window.navigator.userAgent,b="";return/MSIE/g.test(a)?b="-ms-":/Firefox/g.test(a)?b="-moz-":/(WebKit)/i.test(a)?b="-webkit-":/Opera/g.test(a)&&(b="-o-"),b}function d(a){return 0>a?a=0:a>1&&(a=1),100*a+"%"}var e=function(b,e){this.api=b,this.options=e,this.classes={enable:b.namespace+"-gradient_enable",marker:b.namespace+"-gradient-marker",active:b.namespace+"-gradient-marker_active"},this.isOpened=!1,this.initialized=!1,this.current=null,this.$doc=a(document);var f=this;a.extend(f,{init:function(){f.$wrap=a(f.options.template.call(f)).appendTo(b.$dropdown),f.$gradient=f.$wrap.filter("."+b.namespace+"-gradient"),this.angle.init(),this.preview.init(),this.markers.init(),this.wheel.init(),this.bind()},bind:function(){var a=b.namespace;f.options.switchable&&f.$wrap.on("click","."+a+"-gradient-switch",function(){return f.isOpened?f.disable():f.enable(),f.api.position(),f.isOpened=!f.isOpened,!1}),f.$wrap.on("click","."+a+"-gradient-cancel",function(){})},preview:{init:function(){var a=this;f.$preview=f.$gradient.find("."+b.namespace+"-gradient-preview"),f.$gradient.on("add del update",function(){a.render()})},render:function(){f.$preview.css({"background-image":f.gradient.toStringWithAngle("to right",c())}),f.$preview.css({"background-image":f.gradient.toStringWithAngle("to right")})}},markers:{width:160,init:function(){f.$markers=f.$gradient.find("."+b.namespace+"-gradient-markers");var c=this;f.$gradient.on("add",function(a,b){c.add(b.stop.color.toString(),b.stop.position,b.stop.id)}),f.$gradient.on("active",function(a,b){c.active(b.id)}),f.$gradient.on("del",function(a,b){c.del(b.id)}),f.$markers.on("mousedown.asColorInput",function(a){var b=a.which?3===a.which:2===a.button;if(b)return!1;var c=parseFloat((a.pageX-f.$markers.offset().left)/f.markers.width,10);return f.add("#fff",c),!1}),f.$markers.on("mousedown.asColorInput","span",function(a){var b=a.which?3===a.which:2===a.button;return b?!1:(c.mousedown(this,a),!1)}),f.$markers.on("focus.asColorInput","span",function(){if(!a(this).isBinded){var b=a(this).data("id");a(document).on("keydown.asColorInput"+b,function(a){var c=a.keyCode||a.which;if(46===c||8===c){if(f.gradient.length<=2)return;return f.del(b)}}),a(this).isBinded=!0}}).on("blur","span",function(){a(document).off("keydown.asColorInput"+a(this).data("id")),a(this).isBinded=!1}),f.$markers.on("click","span",function(){var b=a(this).data("id");f.active(b)})},add:function(b,c,e){a('<span data-id="'+e+'" style="background: '+b+"; left:"+d(c)+'" class="'+f.classes.marker+'"><i style="background: '+b+'"></i></span>').attr("tabindex",0).appendTo(f.$markers)},del:function(a){f.$markers.find('[data-id="'+a+'"]').remove()},active:function(a){var b=f.$markers.find('[data-id="'+a+'"]');f.$markers.children().removeClass(f.classes.active),b.addClass(f.classes.active),b.focus()},mousedown:function(b,c){var d,e=this,f=a(b).data("id"),g=a(b).position().left,h=c.pageX;return this.mousemove=function(a){d=a.pageX||h;var c=(g+d-h)/this.width;return e.move(b,c,f),!1},this.mouseup=function(){return a(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),!1},a(document).on({mousemove:a.proxy(this.mousemove,this),mouseup:a.proxy(this.mouseup,this)}),a(b).focus(),!1},move:function(b,c,e){c=Math.max(0,Math.min(1,c)),a(b).css({left:d(c)}),e||(e=a(b).data("id")),f.gradient.getById(e).setPosition(c),f.$gradient.trigger("update",{id:a(b).data("id"),position:c})}},wheel:{init:function(){var a=this;f.$wheel=f.$gradient.find("."+b.namespace+"-gradient-wheel"),f.$pointer=f.$wheel.find("i"),f.$gradient.on("update",function(b,c){"undefined"!=typeof c.angle&&a.position(c.angle)}),f.$wheel.on("mousedown.asColorInput",function(b){var c=b.which?3===b.which:2===b.button;return c?!1:(a.mousedown(b,f),!1)})},mousedown:function(b,c){var d=c.$wheel.offset(),e=c.$wheel.width()/2,f=d.left+e,g=d.top+e,h=c.$doc,i=this;this.r=e,this.wheelMove=function(a){var b=a.pageX-f,d=g-a.pageY,e=i.getPosition(b,d),h=i.calAngle(e.x,e.y);c.setAngle(h)},this.wheelMouseup=function(){return h.off({mousemove:this.wheelMove,mouseup:this.wheelMouseup}),!1},h.on({mousemove:a.proxy(this.wheelMove,this),mouseup:a.proxy(this.wheelMouseup,this)}),this.wheelMove(b)},getPosition:function(a,b){var c=this.r,d=a/Math.sqrt(a*a+b*b)*c,e=b/Math.sqrt(a*a+b*b)*c;return{x:d,y:e}},calAngle:function(a,b){var c=Math.round(Math.atan(Math.abs(a/b))*(180/Math.PI));return 0>a&&b>0?360-c:0>a&&0>=b?c+180:a>=0&&0>=b?180-c:a>=0&&b>0?c:void 0},set:function(a){f.gradient.angle(a),f.$gradient.trigger("update",{angle:a})},position:function(a){var b=this.r||f.$wheel.width()/2,c=this.calPointer(a,b);f.$pointer.css({left:c.x,top:c.y})},calPointer:function(a,b){var c=Math.sin(a*Math.PI/180)*b,d=Math.cos(a*Math.PI/180)*b;return{x:b+c,y:b-d}}},angle:{init:function(){f.$angle=f.$gradient.find("."+b.namespace+"-gradient-angle"),f.$angle.on("blur.asColorInput",function(){return f.setAngle(this.value),!1}).on("keydown.asColorInput",function(b){var c=b.keyCode||b.which;return 13===c?(a(this).blur(),!1):void 0}),f.$gradient.on("update",function(a,b){"undefined"!=typeof b.angle&&f.$angle.val(b.angle)})},set:function(a){f.gradient.angle(a),f.$gradient.trigger("update",{angle:a})}}}),this.init()};e.prototype={constructor:e,enable:function(){if(this.$gradient.addClass(this.classes.enable),this.markers.width=this.$markers.width(),this._last)this.gradient=this._last;else{var a=new b;this.gradient=a,this.add(this.api.color.toString(),0,0),this.add(this.api.color.toString(),1,1)}this.api.color=this.gradient,this.$gradient.trigger("update",this.gradient.value)},active:function(a){this.current!==a&&(this.current=a,this.$gradient.trigger("active",{id:a}))},disable:function(){this.$gradient.removeClass(this.classes.enable),this._last=this.gradient,this.api.color.val(this.api.color.get(0).color.toString())},add:function(a,b){var c=this.gradient.insert(a,b);return this.gradient.reorder(),this.$gradient.trigger("add",{stop:c}),this.active(c.id),c},del:function(a){this.gradient.removeById(a),this.gradient.reorder(),this.$gradient.trigger("del",{id:a})},setAngle:function(a){this.gradient.angle(a),this.$gradient.trigger("update",{angle:a})}},a.asColorInput.registerComponent("gradient",{angle:1,count:0,markers:[],current:null,defaults:{switchable:!0,switchText:"Gradient",cancelText:"Cancel",format:function(a){return a?a:void 0},template:function(){var a=this.api.namespace,b='<div class="'+a+'-gradient-control">';return this.options.switchable&&(b+='<a href="#" class="'+a+'-gradient-switch">'+this.options.switchText+"</a>"),b+='<a href="#" class="'+a+'-gradient-cancel">'+this.options.cancelText+"</a></div>",b+'<div class="'+a+'-gradient"><div class="'+a+'-gradient-preview"><div class="'+a+'-gradient-markers"></div></div><div class="'+a+'-gradient-wheel"><i></i></div><input class="'+a+'-gradient-angle" type="text" value="" size="3" /></div>'}},init:function(b,c){var d=this;b.$element.on("asColorInput::ready",function(f,g){"gradient"===g.options.mode&&(c=a.extend(d.defaults,c),b.gradient=new e(b,c))})}})}(jQuery,function(a){return void 0===a.asGradient?!1:a.asGradient}(jQuery));